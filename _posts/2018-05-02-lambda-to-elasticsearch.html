---
layout: default
title: Connecting Lambda to Elasticsearch
comments: true
---

<div>
	<div class="center">
		<img src="../../../img/connections.jpg">
	</div>
	<h1>Connecting Lambda to Elasticsearch</h1>
	<div>
		<p>
			While working recently with setting up a new microservice for cross referencing search results in <a href="https://aws.amazon.com/lambda/" target="_blank">
			aws lambda</a>, I ran into a problem that took a little digging to find the answer to, so I figured I would present it here.
		</p>
		<p>
			If you are hosting an elasticsearch cluster on an EC2 instance and you are restricting access to port 9200 on that EC2 instance,
			you may find that you have some connection issues.
		</p>
		<p>
			The first thing you need to do is start by <a href="https://docs.aws.amazon.com/lambda/latest/dg/vpc.html" target="_blank">
			configuring your VPC settings for your lambda function</a>.  But even after that has been completed you may still experience
			a timeout when trying to access your elasticsearch cluster.  Here's what I found:
		</p>
		<h2><u>You have to use the <em>private</em> ip address of the ec2 instance from your lambda code.</u></h2>
		<p>
			After setting that up, you should be good to go.
		</p>
	</div>
</div>